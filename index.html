<html>

<head>
    <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js" defer></script>
    <link href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" rel="stylesheet">
</head>

<body x-data="data()" x-init="initData">
    <div x-ref="container"
        class="fixed relative overflow-hidden w-full h-full bg-red-300 z-10 text-3xl flex items-center justify-center pb-10">
        <template x-for="number in Array.from(Array(10).keys())">
            <div class="absolute w-full h-full transition-transform transform duration-1000 border border-gray-800 flex items-center justify-center bg-blue-100"
                x-text="'Slideshow ' + (number + 1)"></div>
        </template>
    </div>
    <div class="fixed w-full h-10 z-20 flex justify-center items-center bottom-0 bg-white">
        <button @keydown.arrow-left.window="goToFirstSlide()" @click="goToFirstSlide()"
            class="px-4 font-bold hover:bg-blue-200">&lt;&lt;</button>
        <button @keydown.arrow-left.window="previousSlide()" @click="previousSlide()"
            class="px-4 font-bold hover:bg-blue-200">&lt;</button>
        <div class="px-4 text-xl font-medium">
            <span class="pr-1" x-text="slideshowNumber"></span> of <span class="pl-1" x-text="total"></span>
        </div>
        <button @keydown.arrow-right.window="nextSlide()" @click="nextSlide()"
            class="px-4 font-bold hover:bg-blue-200">&gt;</button>
        <button @keydown.arrow-right.window="goToLastSlide()" @click="goToLastSlide()"
            class="px-4 font-bold hover:bg-blue-200">&gt;&gt;</button>
    </div>
</body>
<script>
    function data() {
        return {
            slideshowNumber: 1,
            total: 0,
            slides: [],
            currentSlide: null,
            firstSlide: null,
            lastSlide: null,

            initData() {
                for (i = 0; i < this.$refs.container.children.length; i++) {
                    var child = this.$refs.container.children[i]

                    if (child.tagName === "TEMPLATE") continue

                    this.total++

                    if (i != this.slideshowNumber) {
                        child.classList.add('translate-x-full')
                    } else {
                        this.currentSlide = child
                    }

                    this.slides.push(child)
                }

                this.firstSlide = this.currentSlide
                this.lastSlide = this.$refs.container.lastElementChild

                console.log(this.slides)
            },

            previousSlide() {
                previousSlide = this.currentSlide.previousElementSibling

                if (!previousSlide || typeof previousSlide === "undefined") return

                this.currentSlide.classList.add('translate-x-full')

                previousSlide.classList.remove('-translate-x-full')

                this.currentSlide = previousSlide
                this.slideshowNumber > 1 ? this.slideshowNumber-- : this.$refs.container.innerText = 'WHAT HAVE YOU DONE???'
            },

            nextSlide() {
                nextSlide = this.currentSlide.nextElementSibling

                if (!nextSlide || typeof nextSlide === "undefined") return

                this.currentSlide.classList.add('-translate-x-full')

                nextSlide.classList.remove('translate-x-full')

                this.currentSlide = nextSlide
                this.slideshowNumber++
            },

            goToFirstSlide() {
                if (this.slideshowNumber == 1) return

                this.slides.forEach(function (slide, index) {
                    if (index == 0) return

                    slide.classList.add('translate-x-full')
                    slide.classList.remove('-translate-x-full')
                })

                this.firstSlide.classList.remove('-translate-x-full')

                this.currentSlide = this.firstSlide
                this.slideshowNumber = 1
            },

            goToLastSlide() {
                if (this.slideshowNumber == this.total) return

                let self = this

                this.slides.forEach(function (slide, index) {
                    console.log("Index:" + index + ".Total:" + self.total)
                    if (index == self.total - 1) return

                    slide.classList.add('-translate-x-full')
                    slide.classList.remove('translate-x-full')
                })

                console.log(this.lastSlide)

                // this.currentSlide.classList.add('-translate-x-full')

                this.lastSlide.classList.remove('translate-x-full')

                this.currentSlide = this.lastSlide
                this.slideshowNumber = this.total
            }
        }
    }
</script>

</html>